/* Newsletter Popup Styles */
.newsletter-popup-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.6);
  z-index: 10002; // Higher than header (10001) and header-banner (10001)
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 1rem;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;

  &--visible {
    opacity: 1;
    visibility: visible;
  }
}

.newsletter-popup {
  background: $pf-yellow; // Yellow background like form block
  border-radius: 12px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  max-width: 500px;
  width: 100%;
  max-height: 75vh; // Increased from 60vh to 75vh
  overflow: hidden; // Hide overflow on container to preserve border-radius
  position: relative;
  transform: scale(0.8) translateY(50px);
  transition: transform 0.3s ease;

  &--visible {
    transform: scale(1) translateY(0);
  }

  &__content {
    padding: 2rem;
    position: relative;
    max-height: 75vh; // Match parent max-height
    overflow-y: auto; // Allow scrolling within content area

    // Custom scrollbar styling for webkit browsers
    &::-webkit-scrollbar {
      width: 6px;
    }

    &::-webkit-scrollbar-track {
      background: rgba($pf-charcoal, 0.1);
      border-radius: 3px;
    }

    &::-webkit-scrollbar-thumb {
      background: rgba($pf-charcoal, 0.3);
      border-radius: 3px;

      &:hover {
        background: rgba($pf-charcoal, 0.5);
      }
    }

    @include media-breakpoint(sm) {
      padding: 1.5rem;
    }
  }

  &__close {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: none;
    border: none;
    color: $pf-charcoal;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s ease, color 0.2s ease;
    z-index: 10;

    &:hover,
    &:focus {
      background-color: $pf-grey;
      color: $pf-charcoal;
      outline: none;
    }

    svg {
      width: 20px;
      height: 20px;
    }
  }

  &__header {
    margin-bottom: 1.5rem;
    padding-right: 2rem; // Space for close button
  }

  &__title {
    font-size: 1.75rem;
    font-weight: 700;
    color: $pf-charcoal; // Black text on yellow background
    margin-bottom: 1rem;
    line-height: 1.3;

    @include media-breakpoint(sm) {
      font-size: 1.5rem;
    }
  }

  &__body {
    color: $pf-charcoal; // Black text on yellow background
    font-size: 1rem;
    line-height: 1.6;
    margin-bottom: 1rem;

    p {
      margin-bottom: 1rem;

      &:last-child {
        margin-bottom: 0;
      }
    }
  }

  &__form {
    small {
      color: $pf-charcoal; // Black text on yellow background
      font-size: 0.875rem;
      margin-bottom: 1rem;
      display: block;
    }
  }

  &__form-container {
    // Newsletter form styling to match form block with yellow background
    font-family: $font--primary;

    // MailChimp form specific styling
    #mc_embed_shell,
    .mc_embed_signup {
      form {
        font-family: $font--primary;

        h2 {
          font-weight: 500;
          font-size: $size--md;
          text-transform: none;
          margin-bottom: 1rem;
          color: $pf-charcoal;
        }

        .indicates-required {
          font-size: $size--sm;
          font-weight: 300;
          margin-bottom: 1rem;
          display: block;
          color: $pf-charcoal;
        }

        .mc-field-group {
          display: flex;
          flex-direction: column;
          margin-bottom: 1rem;

          label {
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: $pf-charcoal;
            text-transform: uppercase; // Uppercase labels like form block
          }

          input:not([type='submit']) {
            border: none;
            background: none;
            border-bottom: 4px solid $pf-charcoal; // Thicker border like form block
            padding: 0.75rem 0.5rem 0.5rem 0;
            width: 100%;
            font-size: 1rem;
            transition: border-color 0.2s ease;
            color: $pf-charcoal;

            &:focus {
              outline: none;
              border-bottom-color: $pf-charcoal;
            }

            &::placeholder {
              color: rgba($pf-charcoal, 0.6);
              text-transform: uppercase; // Uppercase placeholder like form block
            }
          }

          textarea {
            border: none;
            background: none;
            border-bottom: 4px solid $pf-charcoal; // Match form block textarea styling
            padding-left: 0.5rem;
            width: 100%;
            height: 100px;
            margin-top: 0.25rem;
            color: $pf-charcoal;
            font-family: inherit;
            font-size: 1rem;
            transition: border-color 0.2s ease;

            &:focus {
              outline: none;
              border-bottom-color: $pf-charcoal;
            }

            &::placeholder {
              color: rgba($pf-charcoal, 0.6);
              text-transform: uppercase; // Uppercase placeholder like form block
            }
          }
        }

        .clear {
          display: flex;
          justify-content: flex-end;
          margin-top: 1.5rem;
        }

        #mc-embedded-subscribe,
        input[type='submit'],
        button[type='submit'] {
          // Match exact form block button styling
          text-align: center;
          line-height: 22px;
          letter-spacing: 0.06em;
          text-transform: uppercase;
          display: inline-block;
          min-width: fit-content;
          font-size: 16px;
          font-weight: 500;
          text-decoration: none;
          padding: rem(10) rem(25); // Exact padding from button class
          border-radius: 100px; // From button--primary
          background-color: $pf-charcoal !important; // Black button like form block
          color: $pf-white !important;
          border: 1px solid transparent !important;
          cursor: pointer;
          transition: all 0.2s ease;
          width: auto;

          &:hover,
          &:focus {
            background-color: $pf-white !important; // White background on hover like form block
            color: $pf-charcoal !important;
            border-color: $pf-charcoal !important;
            outline: none;
          }
        }
      }
    }

    // Generic form styling for any newsletter form
    label {
      text-transform: uppercase; // Uppercase labels like form block
      font-weight: 500;
      color: $pf-charcoal;
      margin-bottom: 0.5rem;
      display: block;
    }

    .mc-email-input,
    input[type='email'],
    input[type='text'] {
      border: none;
      background: none;
      border-bottom: 4px solid $pf-charcoal; // Thicker border like form block
      padding: 0.75rem 0.5rem 0.5rem 0;
      width: 100%;
      font-size: 1rem;
      transition: border-color 0.2s ease;
      color: $pf-charcoal;

      &:focus {
        outline: none;
        border-bottom-color: $pf-charcoal;
      }

      &::placeholder {
        color: rgba($pf-charcoal, 0.6);
        text-transform: uppercase; // Uppercase placeholder like form block
      }
    }

    textarea {
      border: none;
      background: none;
      border-bottom: 4px solid $pf-charcoal; // Match form block textarea styling
      padding-left: 0.5rem;
      width: 100%;
      height: 100px;
      margin-top: 0.25rem;
      color: $pf-charcoal;
      font-family: inherit;
      font-size: 1rem;
      transition: border-color 0.2s ease;

      &:focus {
        outline: none;
        border-bottom-color: $pf-charcoal;
      }

      &::placeholder {
        color: rgba($pf-charcoal, 0.6);
        text-transform: uppercase; // Uppercase placeholder like form block
      }
    }

    .mc-submit,
    input[type='submit'],
    button[type='submit'] {
      // Match exact form block button styling
      text-align: center;
      line-height: 22px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      display: inline-block;
      min-width: fit-content;
      font-size: 16px;
      font-weight: 500;
      text-decoration: none;
      padding: rem(10) rem(25); // Exact padding from button class
      border-radius: 100px; // From button--primary
      background-color: $pf-charcoal !important; // Black button like form block
      color: $pf-white !important;
      border: 1px solid transparent !important;
      cursor: pointer;
      transition: all 0.2s ease;
      width: auto;
      margin-top: 1rem;

      &:hover,
      &:focus {
        background-color: $pf-white !important; // White background on hover like form block
        color: $pf-charcoal !important;
        border-color: $pf-charcoal !important;
        outline: none;
      }
    }

    // Style success/error messages
    .mc-message,
    .response {
      margin-top: 1rem;
      padding: 0.75rem 1rem;
      border-radius: 6px;
      font-size: 0.875rem;

      &.success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }

      &.error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
    }
  }
}

// Animation for smooth popup appearance
@keyframes newsletterPopupSlideIn {
  from {
    transform: scale(0.8) translateY(50px);
    opacity: 0;
  }
  to {
    transform: scale(1) translateY(0);
    opacity: 1;
  }
}

// Accessibility improvements
.newsletter-popup-overlay {
  // Ensure proper focus management
  &:focus {
    outline: none;
  }

  // Screen reader support
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
}

// Mobile optimizations
@include media-breakpoint(sm) {
  .newsletter-popup-overlay {
    padding: 0.5rem;
  }

  .newsletter-popup {
    max-height: 85vh; // Slightly larger on mobile for better usability

    &__content {
      padding: 1.5rem 1rem;
      max-height: 85vh; // Match parent max-height
    }

    &__close {
      top: 0.5rem;
      right: 0.5rem;
      width: 36px;
      height: 36px;

      svg {
        width: 18px;
        height: 18px;
      }
    }

    &__header {
      padding-right: 2.5rem;
      margin-bottom: 1rem;
    }

    &__title {
      font-size: 1.25rem;
    }
  }
}
